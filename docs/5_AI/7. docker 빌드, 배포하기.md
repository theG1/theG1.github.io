---
layout: default
title: docker ë¹Œë“œ, ë°°í¬í•˜ê¸°
nav_order: 7
parent: AI
---
docker (container) ë¹Œë“œì™€ ë°°í¬ ê²½í—˜ì„ í†µí•´ ì¥ì ì„ ì´í•´í•œë‹¤.

![[Pasted image 20251023092533.png]]

vmê³¼ containerì˜ ì°¨ì´

![[Pasted image 20251023092539.png]]

ì»¨í…Œì´ë„ˆë¥¼ ì´ë£¨ëŠ” ì½”ë“œ êµ¬ì¡°

ë§Œë“¤ì–´ì§„ py ì•±ì„ ë¨¼ì € ì¤€ë¹„í•©ë‹ˆë‹¤

ì´ì œ claude code í•œí…Œ ë¬¼ì–´ë´ì„œ ì§„í–‰í•©ë‹ˆë‹¤.

> _Claude Codeì—ì„œ_ ë‚´ â€œ[ì†ŒìŠ¤ì½”ë“œ.py](http://xn--hy1bp4v9xah58a.py)â€ íŒŒì¼ì„ ê°€ì§€ê³  ë„ì»¤ë¡œ ì˜¬ë¦¬ê³  ì‹¶ì–´, í•„ìš”í•œ íŒŒì¼ì„ ë§Œë“¤ì–´ì£¼ê³  ëª…ë ¹ì–´ë¥¼ ì•Œë ¤ì¤˜

**Dockerì™€ ì»¨í…Œì´ë„ˆëŠ” ì†ŒìŠ¤ì½”ë“œ(.py) íŒŒì¼, requirements.txt, Dockerfile ì„¸ ê°€ì§€ë§Œ ìˆìœ¼ë©´ í•œ ì¤„ì˜ ëª…ë ¹ì–´ë¡œ êµ¬ë™í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.**

```
ë””ë ‰í† ë¦¬(í”„ë¡œì íŠ¸)/
â”œâ”€â”€ abcd.py                      # ë©”ì¸ Streamlit ì• í”Œë¦¬ì¼€ì´ì…˜
â”œâ”€â”€ Dockerfile                   # Docker ì´ë¯¸ì§€ ë¹Œë“œ ì„¤ì •
â”œâ”€â”€ requirements.txt             # Python íŒ¨í‚¤ì§€ ì˜ì¡´ì„±
â””â”€â”€ .dockerignore                # í•„ìˆ˜ ì•„ë‹˜. ì •ë³´ ë³´í˜¸ë¥¼ ìœ„í•œ ì¡°ì¹˜
```

ì˜ˆì œ 1

requirements.txt

```
streamlit
requests
python-detenv
openai
```

ì‹¬í™” ì˜ˆì œ

```
# ê¸°ë³¸ íŒ¨í‚¤ì§€
streamlit
requests

# PDF í…ìŠ¤íŠ¸ ì¶”ì¶œ
PyPDF2

# ì´ë¯¸ì§€ ì²˜ë¦¬
Pillow

# ì´ë¯¸ì§€ OCR (Tesseract - ê¸°ì¡´ ë°©ì‹)
pytesseract

# Base64 ì¸ì½”ë”© (í‘œì¤€ ë¼ì´ë¸ŒëŸ¬ë¦¬)
# base64

# ë‚ ì§œ/ì‹œê°„ ì²˜ë¦¬ (í‘œì¤€ ë¼ì´ë¸ŒëŸ¬ë¦¬ì´ë¯€ë¡œ ì„¤ì¹˜ ë¶ˆí•„ìš”í•˜ì§€ë§Œ ëª…ì‹œ)
# datetime

# íƒ€ì´í•‘ (í‘œì¤€ ë¼ì´ë¸ŒëŸ¬ë¦¬)
# typing

# ì°¸ê³ : Gemma3 ë©€í‹°ëª¨ë‹¬ OCRì€ ì™¸ë¶€ APIë¥¼ ì‚¬ìš©í•˜ë¯€ë¡œ ì¶”ê°€ íŒ¨í‚¤ì§€ ë¶ˆí•„ìš”

```

#ì²˜ë¦¬ ë˜ì–´ìˆëŠ” ê²ƒì€ ì£¼ì„ì…ë‹ˆë‹¤. ì°¸ê³ ë¡œ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.

ì˜ˆì œ2 Dockerfile

```docker
# 1. Python ë² ì´ìŠ¤ ì´ë¯¸ì§€ ì„ íƒ
FROM python:3.11-slim

# 2. ë©”íƒ€ë°ì´í„° ì¶”ê°€
LABEL maintainer="Gemma AI Chatbot"
LABEL description="Streamlit chatbot using Gemma API"

# 3. ì‘ì—… ë””ë ‰í† ë¦¬ ì„¤ì •
WORKDIR /app

# 4. ì‹œìŠ¤í…œ íŒ¨í‚¤ì§€ ì—…ë°ì´íŠ¸ ë° ì •ë¦¬
RUN apt-get update && apt-get install -y --no-install-recommends \\
    curl \\
    && rm -rf /var/lib/apt/lists/*

# 5. requirements ì„¤ì¹˜ (ìºì‹œ ìµœì í™”)
COPY requirements.txt .
RUN pip install --no-cache-dir --upgrade pip && \\
    pip install --no-cache-dir -r requirements.txt

# 6. ì•± ì½”ë“œ ë³µì‚¬ (í•„ìš”í•œ íŒŒì¼ë§Œ)
COPY [abcd.py](<http://abcd.py>) .

# 7. ë¹„root ì‚¬ìš©ì ìƒì„± (ë³´ì•ˆ ê°•í™”)
RUN useradd --create-home --shell /bin/bash appuser && \\
    chown -R appuser:appuser /app
USER appuser

# 8. í—¬ìŠ¤ì²´í¬ ì¶”ê°€
HEALTHCHECK --interval=30s --timeout=10s --start-period=5s --retries=3 \\
  CMD curl -f <http://localhost:8501> || exit 1

# 9. í¬íŠ¸ ë…¸ì¶œ
EXPOSE 8501

# 10. ì‹¤í–‰ ëª…ë ¹
CMD ["streamlit", "run", "[abcd.py](<http://abcd.py>)", \\
     "--server.address=0.0.0.0", \\
     "--server.port=8501", \\
     "--server.headless=true", \\
     "--server.enableCORS=false", \\
     "--server.enableXsrfProtection=false"]
```

### .dockerignore ì¶”ê°€ (ê¶Œì¥)

```
.venv/
__pycache__/
*.pyc
*.log
.env
.git
.gitignore
.DS_Store
```

ê³„ì • ì •ë³´ë‚˜, ê°€ìƒí™˜ê²½, í‚¤ê°’ë“¤ì´ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ì €ì¥ë˜ëŠ” ê²ƒì„ ë§‰ê¸°ìœ„í•´ ì œì™¸í•˜ëŠ” íŒŒì¼ì„ ì§€ì •í•˜ëŠ” ìš©ë„ë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤.

### ì»¨í…Œì´ë„ˆì˜ ë°°í¬ê³¼ì •

![[Pasted image 20251023092550.png]]

### 1) ì´ë¯¸ì§€ ë¹Œë“œ

í”„ë¡œì íŠ¸ ë£¨íŠ¸(.pyíŒŒì¼ì´ ìˆëŠ” í´ë”)ì—ì„œ ì‹¤í–‰í•©ë‹ˆë‹¤.

```bash
docker build -t ì´ë¯¸ì§€ì´ë¦„:íƒœê·¸ .   # "." ì ê¹Œì§€ ì°ì–´ì•¼ í´ë”ë‚´ì˜ ëª¨ë“  íŒŒì¼ì„ í™œìš©í•©ë‹ˆë‹¤.
docker build -t my-streamlit:latest .
```

- -t ëŠ” ì´ë¯¸ì§€ ì´ë¦„:íƒœê·¸ í˜•ì‹ì…ë‹ˆë‹¤. í•„ìš”í•˜ë©´ ë°”ê¾¸ì„¸ìš”.
    
- ë¹Œë“œë˜ì–´ ì˜¬ë¼ì˜¨ ì´ë¯¸ì§€ í™•ì¸
    

```bash
docker images  #ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ í™•ì¸ ëª…ë ¹ì–´

# ì¶œë ¥ ì˜ˆì œ
REPOSITORY                      TAG         IMAGE ID       CREATED        SIZE
chatbot                         latest      9e2dd74fc284   2 weeks ago    560MB
my-st-app                       latest      6639df039e20   3 weeks ago    540MB
<none>                          <none>      11217ace2275   3 weeks ago    540MB
<none>                          <none>      cccc7c00906f   3 weeks ago    540MB
my-streamlit-app                latest      cc4d692b905f   3 weeks ago    540MB
<none>                          <none>      f422101ff8ba   3 weeks ago    540MB
<none>                          <none>      fa9643e1d2ed   3 weeks ago    540MB
python                          3.11-slim   c4640ec0986f   2 months ago   125MB
ghcr.io/open-webui/open-webui   main        21bb7e0892cf   2 months ago   4.78GB
nginx                           latest      2cd1d97f893f   3 months ago   192MB
ollama/ollama                   latest      029391db139c   3 months ago   2.27GB
gcr.io/k8s-minikube/kicbase     v0.0.46     e72c4cbe9b29   9 months ago   1.31GB
```

### 2) ì»¨í…Œì´ë„ˆ ì‹¤í–‰

```bash
# Docker ì»¨í…Œì´ë„ˆ ì‹¤í–‰ ëª…ë ¹ì–´
docker run --rm -it \\                # ì»¨í…Œì´ë„ˆë¥¼ ì‹¤í–‰í•˜ê³ , ì¢…ë£Œ ì‹œ ìë™ ì‚­ì œ(--rm), ì¸í„°ë™í‹°ë¸Œ í„°ë¯¸ë„ ëª¨ë“œ(-it)
  -p 8501:8501 \\                     # í˜¸ìŠ¤íŠ¸ì˜ 8501 í¬íŠ¸ë¥¼ ì»¨í…Œì´ë„ˆì˜ 8501 í¬íŠ¸ì— ë§¤í•‘ (Streamlit ê¸°ë³¸ í¬íŠ¸)
  --name my-streamlit \\              # ì»¨í…Œì´ë„ˆ ì´ë¦„ì„ 'my-streamlit'ìœ¼ë¡œ ì§€ì •
  my-streamlit:latest                # ì‹¤í–‰í•  ì´ë¯¸ì§€ ì´ë¦„ê³¼ íƒœê·¸ ì§€ì • (ë¡œì»¬ì— ìˆëŠ” my-streamlit:latest ì´ë¯¸ì§€ ì‚¬ìš©)

#í™œìš© ëª…ë ¹ì–´
docker run --rm -it \\
  -p 8501:8501 \\
  --name my-streamlit \\
  my-streamlit:latest
```

- ë¸Œë¼ìš°ì €ì—ì„œ [http://localhost:8501](http://localhost:8501) ì ‘ì†í•˜ë©´ ë™ì‘ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    
- ì»¨í…Œì´ë„ˆ ë°°í¬ í˜„í™© í™•ì¸
    

```bash
docker ps   #ë°°í¬ë˜ì–´ ë™ì‘ì¤‘ì¸ ì»¨í…Œì´ë„ˆ í™•ì¸ ëª…ë ¹ì–´

#ì¶œë ¥ ì˜ˆì œ
CONTAINER ID   IMAGE                                COMMAND           CREATED       STATUS                  PORTS                                           NAMES
86ccb74d94c0   ghcr.io/open-webui/open-webui:main   "bash start.sh"   4 weeks ago   Up 18 hours (healthy)   0.0.0.0:18080->8080/tcp, [::]:18080->8080/tcp   open-webui
```

### 3) ë³€ê²½ì‚¬í•­ ë°˜ì˜ íë¦„

1. ì½”ë“œ ìˆ˜ì •
2. ë‹¤ì‹œ ë¹Œë“œ: `docker build -t my-streamlit:latest .`
3. ì»¨í…Œì´ë„ˆ ì¬ì‹¤í–‰

### 4) í™˜ê²½ë³€ìˆ˜ ì‚¬ìš© ì˜ˆì‹œ

```bash
docker run --rm -it -p 8501:8501 \\
  -e GEMMA_API_KEY=your_api_key \\
  my-streamlit:latest
```

- ì½”ë“œì—ì„œ `os.getenv("GEMMA_API_KEY")` ë¡œ ì°¸ì¡°

### ì •ë¦¬

### docker ë¹Œë“œì— í•„ìš”í•œ íŒŒì¼ ì •ë¦¬

ì•„ë˜ 3ê°€ì§€ë§Œ ìˆìœ¼ë©´ ê¸°ë³¸ ë¹Œë“œê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤.

1. requirements.txt

```
streamlit
requests
# í•„ìš”ì‹œ ì¶”ê°€
PyPDF2
Pillow
pytesseract
```

2. Dockerfile

```docker
FROM python:3.11-slim
LABEL maintainer="Gemma AI Chatbot"
WORKDIR /app
RUN apt-get update && apt-get install -y --no-install-recommends \\
    curl \\
  && rm -rf /var/lib/apt/lists/*
COPY requirements.txt .
RUN pip install --no-cache-dir --upgrade pip && \\
    pip install --no-cache-dir -r requirements.txt
COPY [abcd.py](<http://abcd.py>) .
RUN useradd --create-home --shell /bin/bash appuser && \\
    chown -R appuser:appuser /app
USER appuser
HEALTHCHECK --interval=30s --timeout=10s --start-period=5s --retries=3 \\
  CMD curl -f <http://localhost:8501> || exit 1
EXPOSE 8501
CMD ["streamlit", "run", "[abcd.py](<http://abcd.py>)", \\
     "--server.address=0.0.0.0", \\
     "--server.port=8501", \\
     "--server.headless=true", \\
     "--server.enableCORS=false", \\
     "--server.enableXsrfProtection=false"]
```

3. ì• í”Œë¦¬ì¼€ì´ì…˜ íŒŒì¼

```python
# [abcd.py](<http://abcd.py>) (Streamlit ì˜ˆì‹œ)
import os
import streamlit as st

st.set_page_config(page_title="Demo", page_icon="ğŸ¤–", layout="wide")
st.title("Streamlit Demo")
api_key = os.getenv("GEMMA_API_KEY", "<unset>")
st.write(f"GEMMA_API_KEY: {api_key}")

user_input = st.text_input("Say something")
if st.button("Run"):
    st.success(f"You said: {user_input}")
```

ê¶Œì¥) .dockerignore

```
.venv/
__pycache__/
*.pyc
*.log
.env
.git
.gitignore
.DS_Store
```

ì´ì œ ì•„ë˜ ëª…ë ¹ìœ¼ë¡œ ë¹Œë“œì™€ ì‹¤í–‰ì„ ì§„í–‰í•˜ë©´ ë©ë‹ˆë‹¤.

```bash
docker build -t my-streamlit:latest .
docker run --rm -it -p 8501:8501 my-streamlit:latest
```

ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ ì¢…ë£Œ

ã„±. í˜„ì¬ êµ¬ë™ì¤‘ì¸ ì»¨í…Œì´ë„ˆ í™•ì¸

```bash
docker ps   #ë°°í¬ë˜ì–´ ë™ì‘ì¤‘ì¸ ì»¨í…Œì´ë„ˆ í™•ì¸ ëª…ë ¹ì–´

#ì¶œë ¥ ì˜ˆì œ
CONTAINER ID   IMAGE                                COMMAND           CREATED       STATUS                  PORTS                                           NAMES
86ccb74d94c0   ghcr.io/open-webui/open-webui:main   "bash start.sh"   4 weeks ago   Up 18 hours (healthy)   0.0.0.0:18080->8080/tcp, [::]:18080->8080/tcp   open-webui
```

ã„´. ì»¨í…Œì´ë„ˆ ì¤‘ì§€

```bash
docker stop [ì»¨í…Œì´ë„ˆ ID ë˜ëŠ” ì´ë¦„]

# ì‹¤ì œ ì‚¬ìš© ì˜ˆì œ(idê°€ a1b2c3d4e5, nameì´ mysqlì¸ ê²½ìš° ë‘˜ ë‹¤ ê°€ëŠ¥)
docker stop a1b2c3d4e5
docker stop mysql
```

ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ ì‚­ì œ

ã„±. ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ ì¡°íšŒ

```bash
docker images  #ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ í™•ì¸ ëª…ë ¹ì–´

# ì¶œë ¥ ì˜ˆì œ
REPOSITORY                      TAG         IMAGE ID       CREATED        SIZE
chatbot                         latest      9e2dd74fc284   2 weeks ago    560MB
my-st-app                       latest      6639df039e20   3 weeks ago    540MB
<none>                          <none>      11217ace2275   3 weeks ago    540MB
<none>                          <none>      cccc7c00906f   3 weeks ago    540MB
my-streamlit-app                latest      cc4d692b905f   3 weeks ago    540MB
<none>                          <none>      f422101ff8ba   3 weeks ago    540MB
<none>                          <none>      fa9643e1d2ed   3 weeks ago    540MB
python                          3.11-slim   c4640ec0986f   2 months ago   125MB
ghcr.io/open-webui/open-webui   main        21bb7e0892cf   2 months ago   4.78GB
nginx                           latest      2cd1d97f893f   3 months ago   192MB
ollama/ollama                   latest      029391db139c   3 months ago   2.27GB
gcr.io/k8s-minikube/kicbase     v0.0.46     e72c4cbe9b29   9 months ago   1.31GB
```

ã„´. ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ ì‚­ì œ

```bash
docker rmi [ì´ë¯¸ì§€ ID ë˜ëŠ” ì´ë¦„]

# ì‹¤ì œ ì‚¬ìš© ì˜ˆì œ(idê°€ a1b2c3d4e5, nameì´ mysqlì¸ ê²½ìš° ë‘˜ ë‹¤ ê°€ëŠ¥)
docker rmi a1b2c3d4e5
docker rmi mysql
```

[ì»¨í…Œì´ë„ˆ ê¸°íƒ€](https://www.notion.so/28d9de7ee07180569b21e5d3701aa6a5?pvs=21)